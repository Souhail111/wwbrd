const Discord = require('discord.js');
const client = new Discord.Client();



client.on('ready', () => {
  console.log(`Logged in as ${client.user.tag}!`);
	client.user.setGame('w!b (Message) - w&w ðŸŽ†',"https://www.twitch.tv/peery13");
});


client.on('message', message => { // Ù‡Ø§Ø°Ø§ Ù„Ù„Ø¨Ø±ÙˆØ¯ÙƒØ³Ø§Øª
        var prefix = 'w!'; // Ù‡Ù†Ø§ ØªÙ‚Ø¯Ø± ØªØºÙŠØ± Ø§Ù„Ø¨Ø±ÙÙƒØ³
	var command = message.content.split(" ")[0];
	if(command == prefix + 'b') { // Ø§Ù„ÙƒÙˆÙ…Ø§Ù†Ø¯ w!b
		if(!message.member.hasPermission("ADMINISTRATOR")) return message.channel.send("You don`t have **ADMINISTRATOR** permission!");
		var args = message.content.split(' ').slice(1).join(' ');
		if(message.author.bot) return;
		if(!args) return message.channel.send(`**âž¥ Useage:** ${prefix}b ÙƒÙ„Ø§Ù…Ùƒ`);
		if(!message.member.hasPermission("ADMINISTRATOR")) return message.channel.send("You don`t have **ADMINISTRATOR** permission!");
		
		let bcSure = new Discord.RichEmbed()
		.setTitle(`:mailbox_with_mail: **Ù‡Ù„ Ø§Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø§Ù†Ùƒ ØªØ±ÙŠØ¯ Ø§Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø§Ù„Ù‰** ${message.guild.memberCount} **Ø¹Ø¶Ùˆ**`)
		.setThumbnail(client.user.avatarURL)
		.setColor('#4510a8')
		.setDescription(`**\n:envelope: âž¥ Ø±Ø³Ø§Ù„ØªÙƒ**\n\n${args}`)
		.setTimestamp()
		.setFooter(message.author.tag, message.author.avatarURL)
		
		message.channel.send(bcSure).then(msg => {
			msg.react('âœ…').then(() => msg.react('âŽ'));
			message.delete();
			
			
			let yesEmoji = (reaction, user) => reaction.emoji.name === 'âœ…'  && user.id === message.author.id;
			let noEmoji = (reaction, user) => reaction.emoji.name === 'âŽ' && user.id === message.author.id;
			
			let sendBC = msg.createReactionCollector(yesEmoji);
			let dontSendBC = msg.createReactionCollector(noEmoji);
			
			sendBC.on('collect', r => {
				        message.guild.members.forEach(m => {
   if(!message.member.hasPermission('ADMINISTRATOR')) return;
            var bc = new Discord.RichEmbed()
            .setColor('#4510a8')
       .setTitle('Broadcast')
       .addField('Server', message.guild.name)
       .addField('Sender', message.author.username)
       .addField('Message',args)
       .setThumbnail(message.author.avatarURL)
       .setFooter('ðŸ–¤ w&w is Life ðŸ–¤ ', message.guild.iconURL);
            m.send(`${m}`,{embed: bc});
        });
				message.channel.send(`:timer: **ÙŠØªÙ… Ø§Ù„Ø§Ù† Ø§Ù„Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ù‰** \`\`${message.guild.memberCount}\`\` **Ø¹Ø¶Ùˆ**`).then(msg => msg.delete(5000));
				msg.delete();
			})
			dontSendBC.on('collect', r => {
				msg.delete();
				message.reply(':white_check_mark: **ØªÙ… Ø§Ù„ØºØ§Ø¡ Ø§Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­**').then(msg => msg.delete(5000));
			});
		})
	}
});




client.login(process.env.BOT_TOKEN);
